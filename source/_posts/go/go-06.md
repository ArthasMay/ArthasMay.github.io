---
title: 02 | GO:WebServer的实现两种文件上传方式
p: go/go-06
date: 2019-11-13 21:02:06
tags:
- Go
categories: Go
---

## GET和POST的区别

## 浅析http请求头的Content-Type


## upload的两种实现方式

### 字节流上传

* 请求头的Content-Type: application/octet-stream
* 使用Post请求，文件字节流传参到RequestBody中（Postman中有binary设置文件流，其实Application/json协议数据传输方式也是通过字节流传递的，服务端在各自的语言中对字节流进行解析）
* 缺点：
  1. 一次只能传输一个文件
  2. 需要client 和 server 协议确定文件类型
  3. Post的方式只能在body里面设置一个字节流参数，params若要遵循http协议标准，不应该添加参数（当然也可以添加）

### r.Body中字节流的读取 & 写入文件

r.Body中读取字节流的方式需要借助Buffer(缓冲器，之前在Node.js中梳理过Buffer的概念，其实在所有语言中，只要涉及到data的字节流，都会对应的使用到Buffer相关的概念)
``` go
buffer := new(bytes.Buffer)
buffer.ReadFrom(r.Body)
// 创建文件
// 和 chmod 666的概念一样，赋予所有人读和写的权限
f, err := os.OpenFile("./test/" + "demo.pdf", os.O_WRONLY|os.O_CREATE, 0666)
if err != nil {
	fmt.Println("err")
	  return
	}
defer f.Close()
f.Write(buffer.Bytes())
fmt.Fprintf(w, "上传完毕！！！")
```

[Golang中Buffer的使用](https://blog.csdn.net/flyfreelyit/article/details/80291945)
[Golang中常见的Reader的拓展关系](https://blog.csdn.net/lengyuezuixue/article/details/81152876)

### 表单上传（HTTP规范中的Content-Type不包含此类型，算是协议拓展）

